<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/resources/css/usuariosRegistrados.css">
    <%- include('./partials/boostrap.ejs') %> 
    <title>Usuarios registrados</title>
</head>

<body>

  <%- include('./partials/administrador.ejs') %>



  <div class="container mt-4">
      <div class="row">
        <div class="col-md-12">
          <div class="input-group mb-3">
            <input type="text" class="form-control mr-3" placeholder="Buscar usuario" id="search-input">
            <div class="input-group-append">
              <button class="btn btn-outline-success" type="button" id="search-button">
                <i class="fas fa-search"></i>
              </button>
            </div>
          </div>
          <div class="table-wrapper">
            <table class="table table-borderless" id="tabla-usuario">
                <thead>
                    <tr class="bg-success">
                      <th>ID</th>
                      <th>PRODUCTO</th>
                      <th>CANTIDAD</th>
                      <th>RESPONSABLE</th>
                      <th>FECHA DE ENTREGA</th>
                      <th>ESTADO</th>
                      <th>CONFIRMACION</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% datosPrestamo.forEach((prestamo, index) => { %>
                      <tr class="info">
                        <td>
                          <h4 class="info1"><%= prestamo.ID_PRESTAMOS %></h4>
                        </td>
                        <td>
                          <% if (datosReserva[index]) { %>
                            <h4 class="info1"><%= datosReserva[index].NOMBRE_INSUMO %></h4>
                          <% } else { %>
                            <h4 class="info1">-</h4> 
                          <% } %>
                        </td>
                        <td>
                          <% if (datosReserva[index]) { %>
                            <h4 class="info1"><%= datosReserva[index].CANTIDAD %></h4>
                          <% } else { %>
                            <h4 class="info1">-</h4> 
                          <% } %>
                        </td>
                        <td>
                          <h4 class="info1"><%= prestamo.ID_USUARIO %></h4>
                        </td>
                       
                        <td>
                          <% if (datosReserva[index]) { %>
                            <% const fechaPrestamo = new Date(datosReserva[index].FECHA_RES); %>
                            <h4 class="info1"><%= fechaPrestamo.toLocaleDateString() %></h4>
                          <% } else { %>
                            <h4 class="info1">-</h4> 
                          <% } %>
                        </td>
                        <td>
                          <h4 class="info1"><%= prestamo.ESTADO %></h4> </td>
                        <td>
                          <form action="actualizarEstado?id=<%= prestamo.ID_PRESTAMOS %>&estado=ENTREGADO" method="POST">
                            <button id="devuelto" type="submit" class="btn btn-success mr-2" data-id="<%= prestamo.ID_PRESTAMOS %>">Entregado</button>
                          </form>
                        </td>
                      </tr>
                    <% }); %>
                    
                  </tbody>                  
            </table>
          </div>
        </div>
      </div>
    </div>  
   
    </script>
</body>
<%- include('./partials/footer.ejs') %>
</html>
<!--V3-->